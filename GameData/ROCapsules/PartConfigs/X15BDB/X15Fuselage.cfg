PART
{

	name = ROC-X15FuselageBDB
	module = Part
	author = Cobaltwolf,Luci

	RSSROConfig = True
	
	MODEL
	{
		model = ROCapsules/Assets/BDB/X15/bluedog_X15_Fuselage
	}

	scale = 1.0
	rescaleFactor = 1.718 //IDK???
	
	node_stack_top = 0.0, 2.8658, 0.0, 0.0, 1.0, 0.0, 2
	// node_stack_top2 = 0.0, 3.4031, 0.0, 0.0, 1.0, 0.0, 2
	node_stack_bottom = 0.0, -2.4575, 0.0, 0.0, -1.0, 0.0, 2
	node_attach = 0, 0.74, 0.429354, 0, 0, -1, 1
	// mirrorRefAxis = 0, 0, -1
	
	NODE
	{
		name = wingL
		transform = wingL_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = wingR
		transform = wingR_Node
		size = 1
		method = FIXED_JOINT
	}	
	NODE
	{
		name = ventralFin
		transform = ventralFin_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = dorsalFin
		transform = dorsalFin_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = skidL
		transform = skidL_Node
		size = 0
		method = FIXED_JOINT
	}
	NODE
	{
		name = skidR
		transform = skidR_Node
		size = 0
		method = FIXED_JOINT
	}
	NODE
	{
		name = rearWingL
		transform = rearWingL_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = rearWingR
		transform = rearWingR_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = dropTankL
		transform = dropTankL_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = dropTankR
		transform = dropTankR_Node
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = pylonNode
		transform = pylon_Node
		size = 3
		method = FIXED_JOINT
	}

	attachRules = 1,1,1,1,0
	CoPOffset = 0.0, 0.3, 0.0
	CoLOffset = 0.0, 0.3, 0.0
	CoMOffset = 0.0, 0.3, 0
	CenterOfBuoyancy = 0.0, 0.0, -0.3
	CenterOfDisplacement = 0.0, -0.35, 0.0
	buoyancy = 1.75
	buoyancyUseSine = False

	TechRequired = unlockParts
	entryCost = 0
	cost = 2000
	category = Pods
	subcategory = 0
	title = X-15 Fuselage
	manufacturer = North American Aviation
	description = FIXME
	mass = 2.487
	dragModelType = default
	maximum_drag = 0.1
	minimum_drag = 0.1
	angularDrag = 0.75
	breakingForce = 72
	breakingTorque = 72
	crashTolerance = 20
	vesselType = Ship
	CrewCapacity = 0
	bulkheadProfiles = size0, size1p2
	maxTemp = 600

	skinMassPerArea = 13.15				//Beryllium 1.85 ton/m^3. 7.11 mm Beryllium, 13.15 kg/m^2? UNKNOWN, FIXME
	 
	skinTempTag = Inconel
	internalTempTag = Instruments
	skinInsulationTag = True

	tags = X-15 Cockpit

	INTERNAL
	{
		name = mk1CockpitInternal
	}

	MODULE //FIXME
	{
		name = ModuleCommand
		minimumCrew = 0
		hasHibernation = True
		RESOURCE
		{
			name = ElectricCharge
			rate = 0.62		//https://core.ac.uk/download/pdf/42825953.pdf 620 W average power draw
		}
	}

	MODULE //FIXME
	{
		name = ModuleFuelTanks
		type = Structural
		volume = 10145
		basemass = 2.348
		TANK
		{
			name = LqdAmmonia
			amount = 5676.66565517569
			maxAmount = 5676.66565517569
		}
		TANK
		{
			name = LqdOxygen
			amount = 4366.97513616262
			maxAmount = 4366.97513616262
		}
		TANK
		{
			name = HTP
			amount = 100.436408661693
			maxAmount = 100.436408661693
		}
	}

	MODULE
	{
		name = ModuleDataTransmitter
		antennaType = INTERNAL
		packetInterval = 1.0
		packetSize = 2
		packetResourceCost = 12.0
		requiredResource = ElectricCharge
		antennaPower = 5000
		optimumRange = 2500
		packetFloor = .1
		packetCeiling = 5
	}

	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = meshSwitchLength
		switcherDescription = Length
		switcherDescriptionPlural = Lengths
		affectDragCubes = True
		affectFARVoxels = True
		parentID:NEEDS[!RealFuels] = fuelSwitchx15

		SUBTYPE
		{
			name = Base
			transform = Base
		}
		


		SUBTYPE 
		{
			name = Extended
			transform = Extended
			volumeAddedToParent:NEEDS[!RealFuels] = 80 //The real extended X-15A-2 did not use the extra space for additional fuel, but that won't stop us
			CoMOffset = 0, 0.25, 0
			NODE
			{
				name = top
				position = 0.0, 3.40308, 0.0
			}
			NODE
			{
				name = wingL
				position = -0.6531081, 0.696, 0.0 
			}
			NODE
			{
				name = wingR
				position = 0.6531081, 0.696, 0.0 
			}
			node = dropTankL
			node = dropTankR
		}
		
		SUBTYPE 
		{
			name = Extra Extended
			transform = ExtraExtended
			volumeAddedToParent:NEEDS[!RealFuels] = 160 //The real extended X-15A-2 did not use the extra space for additional fuel, but that won't stop us
			CoMOffset = 0, 0.25, 0
			NODE
			{
				name = top
				position = 0.0, 3.9404, 0.0
			}
			NODE
			{
				name = wingL
				position = -0.6531081, 1.23332, 0.0 
			}
			NODE
			{
				name = wingR
				position = 0.6531081, 1.23332, 0.0 
			}
		}
		
		SUBTYPE
		{
			name = Base+Slippers
			transform = Base
			transform = Slippers
			CoMOffset = 0, -0.05, 0
			volumeAddedToParent:NEEDS[!RealFuels] = 50 //The slipper tanks would have extra fuel, no ox, but that's fine
		}
		
		SUBTYPE 
		{
			name = Extended+Slippers
			transform = Extended
			transform = Slippers
			volumeAddedToParent:NEEDS[!RealFuels] = 130 // Add the two fuel increases together
			CoMOffset = 0, 0.2, 0
			NODE
			{
				name = top
				position = 0.0, 3.40308, 0.0
			}
			NODE
			{
				name = wingL
				position = -0.6531081, 0.696, 0.0 
			}
			NODE
			{
				name = wingR
				position = 0.6531081, 0.696, 0.0 
			}
			node = dropTankL
			node = dropTankR
		}
		
		SUBTYPE 
		{
			name = Extra Extended+Slippers
			transform = ExtraExtended
			transform = Slippers
			volumeAddedToParent:NEEDS[!RealFuels] = 210 // Add the two fuel increases together
			CoMOffset = 0, 0.2, 0
			NODE
			{
				name = top
				position = 0.0, 3.9404, 0.0
			}
			NODE
			{
				name = wingL
				position = -0.6531081, 1.23332, 0.0 
			}
			NODE
			{
				name = wingR
				position = 0.6531081, 1.23332, 0.0 
			}
		}
	}
	
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = meshSwitchVents
		switcherDescription = Vent
		switcherDescriptionPlural = Vents
		affectDragCubes = True
		affectFARVoxels = True

		SUBTYPE
		{
			name = XLR99
			transform = XLR99
		}

		SUBTYPE 
		{
			name = XLR11
			transform = XLR11
		}
	}
	
	EFFECTS
	{

		jettison
		{
			AUDIO
			{
				channel = Ship
				clip = sound_rocket_mini
				volume = 0.0 0.0
				volume = 1.0 1.0
				pitch = 0.0 0.75
				pitch = 1.0 0.95
				loop = true
			}
			PREFAB_MULTI_PARTICLE
    			{
      				name = Smoke
      				prefabName = fx_smokeTrail_light
      				transformName = X15_Fuselage
      				emission = 0.0 0.0
      				emission = 0.05 0.0
      				emission = 0.075 0.25
      				emission = 1.0 1.25
					energy = 0.0 .3
					energy = 1.0 .4
      				speed = 0.0 0.25
      				speed = 1.0 0.6
      				localOffset = 0, 0, -3.5
					localScale = 3, 3, 3
					localRotation = 1,0,0,90
    			}
			MODEL_MULTI_PARTICLE
			{
				modelName = Bluedog_DB/FX/PlumeParty/Engines/Smoke/smokeWhiteMB
				transformName = sprayTransform
				emission = 0.0 0.0
				emission = 0.1 0.4
				emission = 1.0 0.6
				energy = 0.0 0
				energy = 1.0 0.04
				speed = 0.0 1
				speed = 1.0 8
				localRotation = 1,0,0,-180
				localScale = .4, .4, .4
				localPosition = 0, 0, 0.15
			}
		}
		
	}
	
	MODULE
	{
		name = ModuleEnginesFX
		thrustVectorTransformName = sprayTransform
		exhaustDamage = False
		ignitionThreshold = 0.1
		minThrust = 1
		maxThrust = 1
		heatProduction = 0
		EngineType = LiquidFuel
		runningEffectName = jettison
		stagingEnabled = false
		nonThrustMotor = True
		PROPELLANT
		{
			name = LiquidFuel
			ratio = 0.9
			DrawGauge = True
		}
		PROPELLANT
		{
			name = Oxidizer
			ratio = 1.1
		}
		useAtmCurveIsp = true
		atmCurveIsp
		{
			key = 0 1 0 0
			key = 0.9 1 0 0
			key = 0.95 1 0 0
			key = 0.97 10 0 0
			key = 1 200 0 0
		}
		atmosphereCurve
		{
		key = 0 200 0 0
		key = 0.9 200 0 0
		key = 0.93 200 0 0
		key = 0.95 20 0 0
		key = 0.97 1 0 0
		key = 1 .1 0 0
		key = 10 .1 0 0
		}
		useVelCurve = true
		velCurve
		{
		key = 0 200 0 0
		key = 0.02 1 0 0
		key = 0.1 .1 0 0
		key = 1 .1 0 0
		key = 10 .1 0 0
		}

	}
	MODULE
	{
		name = ModuleB9AssignUiGroups
		MODULE
		{
			IDENTIFIER
			{
				name = ModuleEnginesFX
				thrustVectorTransformName = sprayTransform
				
			}
			uiGroupName = vent
			uiGroupDisplayName = Fuel Vent
		}
	}
	MODULE
	{
		name = ModuleBdbDefAGHelper
		actionModuleName = ModuleEnginesFX
		actionModuleIndex = 0 // Index if more than one module with same name
		actionName = OnAction
		actionDefaultActionGroup = Custom09
	}
	
		MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = textureSwitchPaint
		uiGroupName = paint
		uiGroupDisplayName = Paint Switch
		switcherDescription = Coating
		switcherDescriptionPlural = Coatings
		affectDragCubes = False
		affectFARVoxels = False
		SUBTYPE
		{
			name = Blue Inconel
			primaryColor = #35383e
		}
	}
}

//	================================================================================
//	Reduce power draw to compensate for RA antennas
//	================================================================================
@PART[ROC-GeminiCMBDB]:NEEDS[RealAntennas]
{
	@MODULE[ModuleCommand]
	{
		@RESOURCE[ElectricCharge]
		{
			@rate -= 0.0514 //Remove Antenna idle power draw. Assuming two TL4 Antennas using 25.7 W idle
		}
	}
}

//	================================================================================
//	Override RO global settings to get our temperatures back
//	================================================================================
@PART[ROC-GeminiCMBDB]:AFTER[RealismOverhaul_Materials]
{
	@skinMaxTemp = 1255		//Raising this until we can find a better way to deal with excess heat flux
}
